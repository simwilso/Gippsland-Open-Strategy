name: PR Approval â†’ Swarm
on:
  pull_request:
    types: [labeled]
jobs:
  run-swarm:
    if: contains(join(github.event.pull_request.labels.*.name), 'ready-for-swarm')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install Claude-Flow
        run: npm install -g claude-flow@alpha
      
      - name: Run Claude-Flow Swarm
        run: |
          # For now, this creates a mock output
          # In production, you would run Claude-Flow locally and push results
          echo '{"strategy":"open_new_pr","branchName":"swarm/output","summary":"Swarm processed changes","artifacts":[{"path":"docs/generated.md","content":"# Generated by Swarm\n\nThis content would be generated by running Claude-Flow locally."}]}' > swarm-output.json
      
      - name: Apply Swarm Output
        run: |
          chmod +x ./flows/adapters/github.ts
          node ./flows/adapters/github.ts apply swarm-output.json